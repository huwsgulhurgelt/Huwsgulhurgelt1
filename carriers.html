<!DOCTYPE html>
<html lang="mn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–æ–ª–æ–º–∂–∏—Ç —Ö“Ø—Ä–≥—ç–≥—á–∏–¥ - –ú”©—Ä”©–Ω –•“Ø—Ä–≥—ç–ª—Ç</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Parallax Background -->
    <div class="parallax-bg">
        <div class="parallax-layer layer-1" data-speed="0.2">
            <div class="ball"></div>
            <div class="ball"></div>
            <div class="ball"></div>
            <div class="ball"></div>
        </div>
        <div class="parallax-layer layer-2" data-speed="0.5">
            <div class="ball"></div>
            <div class="ball"></div>
            <div class="ball"></div>
        </div>
        <div class="parallax-layer layer-3" data-speed="1">
            <div class="ball"></div>
            <div class="ball"></div>
            <div class="ball"></div>
        </div>
    </div>

    <div class="container">
        <header class="page-header">
            <a href="index.html" class="back-link">‚Üê –ë—É—Ü–∞—Ö</a>
            <h1>–ë–æ–ª–æ–º–∂–∏—Ç —Ö“Ø—Ä–≥—ç–≥—á–∏–¥</h1>
        </header>

        <main id="carriersContainer" class="carriers-grid">
            <div class="loading">–£–Ω—à–∏–∂ –±–∞–π–Ω–∞...</div>
        </main>

        <footer>
            <p>–°—É—Ä–≥—É—É–ª–∏–π–Ω —Ç”©—Å”©–ª ‚Ä¢ Prototype</p>
        </footer>
    </div>

    <script>
        // Parallax scroll effect
        window.addEventListener('scroll', () => {
            const layers = document.querySelectorAll('.parallax-layer');
            const scrolled = window.pageYOffset;

            layers.forEach(layer => {
                const speed = layer.dataset.speed;
                const yPos = -(scrolled * speed);
                layer.style.transform = `translateY(${yPos}px)`;
            });
        });
    </script>

    <script type="module">
        // Import Firebase
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { getDatabase, ref, onValue, remove } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js';

        // Your Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyArvfvF1FWfqNAJnzfNiyEq0Lm2qioPIas",
            authDomain: "huwsgul-hurgelt.firebaseapp.com",
            databaseURL: "https://huwsgul-hurgelt-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "huwsgul-hurgelt",
            storageBucket: "huwsgul-hurgelt.firebasestorage.app",
            messagingSenderId: "457877716370",
            appId: "1:457877716370:web:5bc6e08801e36010c3d54b"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        const carriersContainer = document.getElementById('carriersContainer');

        // Load carriers from Firebase
        onValue(ref(database, 'carriers'), (snapshot) => {
            carriersContainer.innerHTML = ''; // Clear loading message

            if (!snapshot.exists()) {
                carriersContainer.innerHTML = '<div class="no-data">–û–¥–æ–æ–≥–æ–æ—Ä —Ö“Ø—Ä–≥—ç–≥—á –±–∞–π—Ö–≥“Ø–π –±–∞–π–Ω–∞.</div>';
                return;
            }

            const carriers = snapshot.val();
            
            Object.keys(carriers).forEach(key => {
                const carrier = carriers[key];
                const card = createCarrierCard(key, carrier);
                carriersContainer.appendChild(card);
            });
        });

        function createCarrierCard(id, carrier) {
            const card = document.createElement('div');
            card.className = 'carrier-card';

            const daysText = carrier.days ? carrier.days.join(', ') : '”®–¥”©—Ä —Å–æ–Ω–≥–æ–æ–≥“Ø–π';

            card.innerHTML = `
                <div class="card-content">
                    <div class="carrier-phone">${carrier.phone}</div>
                    <div class="carrier-description">${carrier.description}</div>
                    <div class="carrier-days">üìÖ ${daysText}</div>
                </div>
                <div class="card-actions">
                    <button class="btn-small btn-edit" onclick="editCarrier('${id}')">–ó–∞—Å–∞—Ö</button>
                    <button class="btn-small btn-delete" onclick="deleteCarrier('${id}')">–£—Å—Ç–≥–∞—Ö</button>
                </div>
            `;

            return card;
        }

        // Make functions globally accessible
        window.editCarrier = function(id) {
            const pin = prompt('PIN –∫–æ–¥ –æ—Ä—É—É–ª–Ω–∞ —É—É:');
            if (!pin) return;

            // Get the carrier data to verify PIN
            onValue(ref(database, `carriers/${id}`), (snapshot) => {
                if (snapshot.exists()) {
                    const carrier = snapshot.val();
                    
                    if (carrier.pin !== pin) {
                        alert('–ë—É—Ä—É—É PIN –∫–æ–¥!');
                        return;
                    }

                    // If PIN is correct, allow editing
                    const newPhone = prompt('–®–∏–Ω—ç —É—Ç–∞—Å–Ω—ã –¥—É–≥–∞–∞—Ä:', carrier.phone);
                    if (!newPhone) return;

                    const newDescription = prompt('–®–∏–Ω—ç —Ç–∞–π–ª–±–∞—Ä:', carrier.description);
                    if (!newDescription) return;

                    // You could add day selection here too
                    alert('–ó–∞—Å–≤–∞—Ä–ª–∞—Ö —Ñ—É–Ω–∫—Ü —É–¥–∞—Ö–≥“Ø–π –Ω—ç–º—ç–≥–¥—ç–Ω—ç!');
                }
            }, { onlyOnce: true });
        };

        window.deleteCarrier = function(id) {
            const pin = prompt('–£—Å—Ç–≥–∞—Ö—ã–Ω —Ç—É–ª–¥ PIN –∫–æ–¥ –æ—Ä—É—É–ª–Ω–∞ —É—É:');
            if (!pin) return;

            // EMERGENCY MASTER PIN - Change this to your secret code!
            const MASTER_PIN = "9999"; // ‚ö†Ô∏è CHANGE THIS TO YOUR OWN SECRET PIN!

            // Check if it's the master PIN
            if (pin === MASTER_PIN) {
                if (confirm('–ê–¥–º–∏–Ω —ç—Ä—Ö—ç—ç—Ä —É—Å—Ç–≥–∞—Ö —É—É?')) {
                    remove(ref(database, `carriers/${id}`))
                        .then(() => {
                            alert('–ê–º–∂–∏–ª—Ç—Ç–∞–π —É—Å—Ç–≥–∞–ª–∞–∞!');
                        })
                        .catch((error) => {
                            console.error('Error:', error);
                            alert('–ê–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞!');
                        });
                }
                return;
            }

            // Normal PIN verification
            onValue(ref(database, `carriers/${id}`), (snapshot) => {
                if (snapshot.exists()) {
                    const carrier = snapshot.val();
                    
                    if (carrier.pin !== pin) {
                        alert('–ë—É—Ä—É—É PIN –∫–æ–¥!');
                        return;
                    }

                    // If PIN is correct, delete
                    if (confirm('–¢–∞ –∏—Ç–≥—ç–ª—Ç—ç–π –±–∞–π–Ω–∞ —É—É?')) {
                        remove(ref(database, `carriers/${id}`))
                            .then(() => {
                                alert('–ê–º–∂–∏–ª—Ç—Ç–∞–π —É—Å—Ç–≥–∞–ª–∞–∞!');
                            })
                            .catch((error) => {
                                console.error('Error:', error);
                                alert('–ê–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞!');
                            });
                    }
                }
            }, { onlyOnce: true });
        };
    </script>
</body>
</html>
